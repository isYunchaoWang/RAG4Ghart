# Vega-Lite 图表样式配置功能

## 概述

本次更新为Vega-Lite图表编辑器添加了全面的样式配置功能，让用户可以轻松自定义图表的视觉效果。

## 新增功能

### 1. 基础样式配置

#### 透明度配置
- 支持0.1到1.0的透明度调节
- 适用于所有图表类型

### 2. 边框和线条配置

#### 边框设置
- **边框宽度**: 0-5像素的边框宽度调节

#### 线条样式（适用于线图）
- **线条宽度**: 0.5-10像素的线条宽度
- **线条样式**: 实线、虚线、点线、点划线

### 3. 图表特定样式

#### 柱状图样式
- **圆角半径**: 0-20像素的圆角设置

#### 点图样式
- **点大小**: 1-100像素的点大小调节

#### 饼图样式
- **内半径**: 0-100像素的内半径设置（创建环形图）

### 4. 字体配置

#### 字体设置
- **字体族**: Arial、Helvetica、Times New Roman、Georgia等
- **字体大小**: 8-32像素的字体大小

### 5. 坐标轴配置

#### 轴位置
- **X轴位置**: 顶部、底部、左侧、右侧
- **Y轴位置**: 顶部、底部、左侧、右侧

#### 网格设置
- **显示网格**: 开启/关闭网格线

### 6. 图例配置

#### 图例设置
- **显示图例**: 开启/关闭图例显示
- **图例位置**: 顶部、底部、左侧、右侧
- **图例方向**: 水平、垂直

### 7. 交互配置

#### 交互功能
- **工具提示**: 开启/关闭悬停提示
- **缩放**: 启用图表缩放功能
- **平移**: 启用图表平移功能
- **选择**: 启用图例选择功能

## 使用方法

### 1. 选择图表类型
首先在"图表类型"下拉菜单中选择要创建的图表类型。

### 2. 配置数据字段
在"字段配置"部分设置X轴、Y轴、颜色、大小等数据字段。

### 3. 自定义样式
在"样式配置"部分：
- 调整透明度和边框设置
- 根据图表类型设置特定样式（如圆角、点大小等）
- 配置字体、坐标轴和图例

### 4. 输入数据
在"数据"文本框中输入JSON格式的数据数组。

### 5. 保存图表
点击"保存到历史"按钮将当前配置保存到历史记录中。

## 支持的图表类型

### 基础图表
- 柱状图 (bar)
- 折线图 (line)
- 散点图 (scatter)
- 点图 (point)
- 饼图 (pie)

### 高级图表
- 堆叠柱状图 (stacked_bar)
- 堆叠面积图 (stacked_area)
- 气泡图 (bubble)
- 热力图 (heatmap)
- 箱线图 (box)
- 小提琴图 (violin)
- 树状图 (treemap)
- 旭日图 (sunburst)
- 桑基图 (sankey)

## 技术实现

### 组件结构
- `ChartEditor.jsx`: 主编辑器组件
- `StyleConfig.jsx`: 样式配置组件
- `ChartConfig.jsx`: 字段配置组件

### 核心功能
- `buildSpecFromForm()`: 根据表单配置生成Vega-Lite规范
- `pickFormFromSpec()`: 从Vega-Lite规范提取表单配置
- `mapChartTypeToVegaMark()`: 图表类型到Vega标记的映射

### 样式配置映射
所有样式配置都会正确映射到Vega-Lite规范的相应属性：
- Mark属性：color、fill、opacity、stroke、strokeWidth等
- Config属性：axis、legend、title等

## 示例

### 基础柱状图配置
```json
{
  "chartType": "bar",
  "xField": "category",
  "yField": "value",
  "markColor": "#1890ff",
  "cornerRadius": 5,
  "opacity": 0.8,
  "showGrid": true
}
```

### 堆叠柱状图配置（使用颜色方案）
```json
{
  "chartType": "stacked_bar",
  "xField": "category",
  "yField": "value",
  "colorField": "type",
  "colorScheme": "category10",
  "cornerRadius": 3,
  "opacity": 0.9
}
```

### 高级线图配置
```json
{
  "chartType": "line",
  "xField": "time",
  "yField": "value",
  "colorField": "series",
  "lineWidth": 2,
  "strokeDash": [5, 5],
  "colorScheme": "category10"
}
```

## 注意事项

1. **兼容性**: 某些样式配置可能不适用于所有图表类型
2. **性能**: 复杂的样式配置可能影响渲染性能
3. **数据格式**: 确保输入的数据格式正确
4. **浏览器支持**: 建议使用现代浏览器以获得最佳体验

## 未来计划

- 添加更多颜色方案
- 支持自定义渐变
- 添加动画配置
- 支持主题切换
- 添加更多交互功能
